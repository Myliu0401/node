<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    /* 
                  express的中间件: 就是请求方式函数的第二个参数回调函数,这个回调函数就是express中间件。
                       如: Application.get('路径',回调函数)  这个回调函数就是 express中间件。
                       
                    中间件函数: 
                          如果有多个中间件,都匹配得上(也就是请求方式和请求路径,都匹配得上),那么只执行第一个中间件函数,只有中间件执行了next函数,才会执行后续相应的中间件。
                          中间件函数其实会有4个形参:第一个为err错误信息  第二个为Request对象  第三个为Response对象  第四个为next函数。
                            如果中间件有报错,express执行下个中间件时才会传4个实参, 第一个是前面中间件报错的信息, 其他3个实参为正常的参数。
                             
                             只有执行第四个形参函数,next函数时,才会执行第二个匹配得上的中间件函数,以此类推。(相当于手动交给后续中间件函数)
                             如果最后一个中间件函数里也执行next函数,也不会报错。
                         
                          细节: 
                            1.如果最后一个中间件函数里还有体交,也就是执行next函数,并且前面执行到的中间件没有执行 end函数,也就是发回响应完毕,
                              因为是最后一个中间件了,express会,自动发回响应,响应码为404。
                            
                            2.如果中间件都有执行next函数提交给后续中间件,但其中有中间件执行了 end函数,也就是发回响应完毕,最后一个中间件执行next函数,
                              express也不会发回响应,因为前面中间件已经发了。

                            3.如果前面中间件函数有执行 end函数,发回响应完毕,那么执行next函数提交给后续的中间件时,后续的中间件就不能执行 end函数了,否则会报错,
                              也就是中间中只能一个中间函数执行一个end函数。

                            4.如果中间件函数中,报错了那么会自动执行next函数,并且将错误作为next函数的参数,不会执行后续的中间件,而是寻找处理错误的中间件,
                              相当找看那个中间件有4个形参,并且是请求方式函数use的回调中间件,然后执行它,然后再从这个中间件开始执行后续的中间件。
                              如果没有处理错误的中间件,也就是没有4个形参的中间件,那么express会自动返回响应,响应体为错误信息,响应码为500。
                              
                            5.如果中间件有4个形参,那么express,会认为它是处理错误的中间件,只有错误了,并且是请求方式函数use的回调中间件
                              才会执行到这个中间件,如果没有错误,则不会执行4个形参的中间件。
                              如果没有错误,有4个形参的中间件都不会被执行。
                              如果有错误,只执行请求方式函数use的4个形参的回调中间件。
                              
                            6. ** express不支持异步函数里报错自动捕获给处理错误的中间件,所以只能手动提交,将错误信息传进去 **
                               这里跟 关键字 async 有关,请阅读 express路由文件夹里的 路由层调用学生服务哪里
                            
        
        
        */
  </script>
</body>

</html>